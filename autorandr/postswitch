#!/bin/sh
# per chatgpt I need to unset I3SOCK
unset I3SOCK
log="$HOME/.cache/autorandr.log"

case "$AUTORANDR_CURRENT_PROFILE" in
laptop) echo "Xft.dpi: 162" | xrdb -merge ;;
docked) echo "Xft.dpi: 96" | xrdb -merge ;;
*) echo "$(date): no dpi rule for $AUTORANDR_CURRENT_PROFILE" >>"$log" ;;
esac

if pgrep -x i3lock >/dev/null; then
    i3-msg reload
else
    i3-msg restart
fi

if pgrep -x firefox >/dev/null; then
    pkill -x firefox
    i3-msg 'workspace 1; exec firefox'
fi

if pgrep -x brave-browser >/dev/null; then
    pkill -x brave-browser
    i3-msg 'workspace 1; exec brave-browser'
fi

if pgrep -x dunst >/dev/null; then
    pkill -x dunst
    dunst &
fi

if pgrep -x 1password >/dev/null; then
    pkill -x 1password
fi
